{% extends 'soulstrader/base.html' %}

{% block title %}Notifications - SOULTRADER{% endblock %}

{% block content %}
<div class="card">
    <h1 style="color: #667eea; margin-bottom: 1rem;">Notifications</h1>
    <p style="color: #6c757d; margin-bottom: 2rem;">Stay updated with your portfolio, AI recommendations, and market insights.</p>
    
    <!-- Notification Stats -->
    <div style="display: flex; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap;">
        <div style="padding: 1rem; background-color: #f8f9fa; border-radius: 8px; border-left: 4px solid #667eea;">
            <div style="font-size: 1.2rem; font-weight: bold; color: #333;">{{ notifications|length }}</div>
            <div style="color: #6c757d; font-size: 0.9rem;">Total Notifications</div>
        </div>
        <div style="padding: 1rem; background-color: #f8f9fa; border-radius: 8px; border-left: 4px solid #28a745;">
            <div style="font-size: 1.2rem; font-weight: bold; color: #333;">
                {{ notifications|length|add:"-1"|add:"-1"|add:"-1" }}
            </div>
            <div style="color: #6c757d; font-size: 0.9rem;">Unread</div>
        </div>
        <div style="padding: 1rem; background-color: #f8f9fa; border-radius: 8px; border-left: 4px solid #17a2b8;">
            <div style="font-size: 1.2rem; font-weight: bold; color: #333;">Today</div>
            <div style="color: #6c757d; font-size: 0.9rem;">Recent Activity</div>
        </div>
    </div>
</div>

{% if notifications %}
<div class="card">
    <h2 style="margin-bottom: 1.5rem; color: #333;">All Notifications</h2>
    
    {% for notification in notifications %}
    <div style="border: 1px solid #e9ecef; border-radius: 8px; padding: 1.5rem; margin-bottom: 1rem; 
                {% if not notification.is_read %}background-color: #f8f9fa; border-left: 4px solid #667eea;{% else %}background-color: white;{% endif %}">
        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
            <div style="flex: 1;">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                    <div style="padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; font-weight: 500;
                                {% if notification.notification_type == 'RECOMMENDATION' %}background-color: #e3f2fd; color: #1976d2;
                                {% elif notification.notification_type == 'TRADE_EXECUTED' %}background-color: #e8f5e8; color: #2e7d32;
                                {% elif notification.notification_type == 'PORTFOLIO_ALERT' %}background-color: #fff3e0; color: #f57c00;
                                {% elif notification.notification_type == 'MARKET_UPDATE' %}background-color: #f3e5f5; color: #7b1fa2;
                                {% else %}background-color: #f5f5f5; color: #616161;{% endif %}">
                        {{ notification.get_notification_type_display }}
                    </div>
                    {% if not notification.is_read %}
                        <div style="padding: 0.25rem 0.5rem; background-color: #667eea; color: white; border-radius: 8px; font-size: 0.7rem; font-weight: bold;">
                            NEW
                        </div>
                    {% endif %}
                </div>
                <h3 style="margin: 0; color: #333; font-size: 1.1rem;">{{ notification.title }}</h3>
                <p style="margin: 0.5rem 0 0 0; color: #555; line-height: 1.5;">{{ notification.message }}</p>
            </div>
            <div style="text-align: right; margin-left: 1rem;">
                <div style="font-size: 0.9rem; color: #6c757d; margin-bottom: 0.5rem;">
                    {{ notification.created_at|date:"M d, Y" }}
                </div>
                <div style="font-size: 0.8rem; color: #6c757d;">
                    {{ notification.created_at|time:"H:i" }}
                </div>
            </div>
        </div>
        
        <div style="display: flex; gap: 1rem; align-items: center; justify-content: space-between;">
            <div style="font-size: 0.9rem; color: #6c757d;">
                {% if notification.is_sent %}
                    <span class="positive">✓ Sent</span>
                {% else %}
                    <span style="color: #ffc107;">⏳ Pending</span>
                {% endif %}
                {% if notification.read_at %}
                    • Read: {{ notification.read_at|date:"M d, H:i" }}
                {% endif %}
            </div>
            <div style="display: flex; gap: 0.5rem;">
                {% if not notification.is_read %}
                    <button class="btn btn-secondary" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">Mark as Read</button>
                {% endif %}
                <button class="btn" style="padding: 0.25rem 0.75rem; font-size: 0.8rem; background-color: #17a2b8;">View Details</button>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="card">
    <h2 style="margin-bottom: 1.5rem; color: #333;">No Notifications</h2>
    <div style="text-align: center; padding: 3rem; color: #6c757d;">
        <h3 style="margin-bottom: 1rem;">All caught up!</h3>
        <p style="margin-bottom: 2rem;">You don't have any notifications at the moment.</p>
        <p style="margin-bottom: 2rem;">We'll notify you about:</p>
        <ul style="text-align: left; max-width: 400px; margin: 0 auto 2rem auto;">
            <li>New AI recommendations</li>
            <li>Trade executions</li>
            <li>Portfolio alerts and updates</li>
            <li>Market updates and insights</li>
            <li>Rebalancing reminders</li>
        </ul>
        <a href="{% url 'soulstrader:dashboard' %}" class="btn">Back to Dashboard</a>
    </div>
</div>
{% endif %}

<!-- Notification Settings -->
<div class="card">
    <h2 style="margin-bottom: 1.5rem; color: #333;">Notification Settings</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem;">
        <div>
            <h4 style="color: #667eea; margin-bottom: 1rem;">Communication Channels</h4>
            <div style="line-height: 1.8;">
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid #e9ecef;">
                    <span><strong>Email Notifications</strong></span>
                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                        <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #28a745; border-radius: 24px; transition: 0.4s;"></span>
                    </label>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid #e9ecef;">
                    <span><strong>SMS Notifications</strong></span>
                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                        <input type="checkbox" style="opacity: 0; width: 0; height: 0;">
                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; border-radius: 24px; transition: 0.4s;"></span>
                    </label>
                </div>
            </div>
        </div>
        <div>
            <h4 style="color: #667eea; margin-bottom: 1rem;">Notification Types</h4>
            <div style="line-height: 1.8;">
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid #e9ecef;">
                    <span><strong>Daily Summary</strong></span>
                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                        <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #28a745; border-radius: 24px; transition: 0.4s;"></span>
                    </label>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid #e9ecef;">
                    <span><strong>Recommendation Alerts</strong></span>
                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                        <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #28a745; border-radius: 24px; transition: 0.4s;"></span>
                    </label>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid #e9ecef;">
                    <span><strong>Trade Executions</strong></span>
                    <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                        <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                        <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #28a745; border-radius: 24px; transition: 0.4s;"></span>
                    </label>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="card">
    <h2 style="margin-bottom: 1.5rem; color: #333;">Quick Actions</h2>
    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <button class="btn">Mark All as Read</button>
        <button class="btn btn-secondary">Clear All</button>
        <button class="btn" style="background-color: #17a2b8;">Refresh Notifications</button>
        <a href="{% url 'soulstrader:profile' %}" class="btn" style="background-color: #6f42c1;">Notification Settings</a>
        <a href="{% url 'soulstrader:dashboard' %}" class="btn btn-secondary">Back to Dashboard</a>
    </div>
</div>
{% endblock %}
